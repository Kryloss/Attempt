@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Advanced nutrition toggle helper: add class to root when enabled via JS */
.advanced-nutrition .advanced-hidden {
    display: none;
}

@layer base {
    html {
        font-family: 'Inter', system-ui, sans-serif;
        /* Ensure proper mobile scaling */
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
    }

    body {
        /* Neon-inspired layered background for light mode */
        background:
            radial-gradient(1200px circle at 10% 10%, rgba(168, 85, 247, 0.12), transparent 40%),
            radial-gradient(800px circle at 90% 20%, rgba(192, 132, 252, 0.15), transparent 45%),
            radial-gradient(1000px circle at 30% 90%, rgba(216, 180, 254, 0.12), transparent 50%),
            conic-gradient(from 180deg at 50% 50%, rgba(168, 85, 247, 0.06), rgba(192, 132, 252, 0.04), rgba(216, 180, 254, 0.06), rgba(168, 85, 247, 0.06)),
            linear-gradient(135deg, #faf5ff 0%, #f7f0ff 50%, #efe6ff 100%);
        background-repeat: no-repeat;
        background-attachment: fixed;
        min-height: 100vh;
        /* Prevent horizontal scrolling on mobile */
        overflow-x: hidden;
    }

    .dark body {
        /* Neon-inspired layered background for dark mode */
        background:
            radial-gradient(1200px circle at 10% 10%, rgba(168, 85, 247, 0.15), transparent 40%),
            radial-gradient(900px circle at 85% 15%, rgba(126, 34, 206, 0.25), transparent 45%),
            radial-gradient(1000px circle at 20% 85%, rgba(59, 7, 100, 0.25), transparent 50%),
            linear-gradient(135deg, #0b1020 0%, #0d1224 50%, #0f1529 100%);
        background-repeat: no-repeat;
        background-attachment: fixed;
    }

    /* Animated neon overlays */
    body::before {
        content: '';
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        background:
            radial-gradient(40vw 40vw at 10% 10%, rgba(168, 85, 247, 0.18), transparent 60%),
            radial-gradient(35vw 35vw at 80% 15%, rgba(192, 132, 252, 0.18), transparent 62%),
            radial-gradient(45vw 45vw at 20% 85%, rgba(216, 180, 254, 0.16), transparent 65%);
        mix-blend-mode: screen;
        animation: neon-aurora 28s ease-in-out infinite alternate, hue-shift 40s linear infinite alternate;
    }

    .dark body::before {
        background:
            radial-gradient(40vw 40vw at 12% 12%, rgba(168, 85, 247, 0.22), transparent 60%),
            radial-gradient(35vw 35vw at 82% 18%, rgba(126, 34, 206, 0.28), transparent 62%),
            radial-gradient(45vw 45vw at 25% 82%, rgba(59, 7, 100, 0.35), transparent 65%);
        mix-blend-mode: lighten;
        animation: neon-aurora 30s ease-in-out infinite alternate;
    }

    body::after {
        content: '';
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        background:
            radial-gradient(120% 120% at 50% 50%, transparent 62%, rgba(168, 85, 247, 0.06) 100%),
            repeating-linear-gradient(45deg, rgba(168, 85, 247, 0.05) 0 2px, rgba(168, 85, 247, 0) 2px 10px),
            radial-gradient(2px 2px at 25% 35%, rgba(168, 85, 247, 0.03), transparent 3px),
            radial-gradient(2px 2px at 75% 65%, rgba(168, 85, 247, 0.03), transparent 3px);
        background-size: auto, 200px 200px, 200px 200px, 240px 240px;
        background-repeat: no-repeat, repeat, repeat, repeat;
        background-position: center center, 0 0, 25% 35%, 75% 65%;
        animation: neon-lines 60s linear infinite;
    }

    .dark body::after {
        background: radial-gradient(120% 120% at 50% 50%, transparent 55%, rgba(0, 0, 0, 0.25) 100%);
    }

    @keyframes neon-aurora {
        0% {
            transform: translate3d(0, 0, 0) scale(1);
            filter: saturate(1);
        }

        50% {
            transform: translate3d(0.5%, -0.5%, 0) scale(1.02);
            filter: saturate(1.05);
        }

        100% {
            transform: translate3d(-0.5%, 0.5%, 0) scale(1);
            filter: saturate(1);
        }
    }

    @keyframes hue-shift {
        0% {
            filter: hue-rotate(0deg) saturate(1);
        }

        100% {
            filter: hue-rotate(15deg) saturate(1.05);
        }
    }

    @keyframes neon-lines {
        0% {
            background-position: center center, 0 0, 25% 35%, 75% 65%;
        }

        100% {
            background-position: center center, 200px 200px, 25% 35%, 75% 65%;
        }
    }

    /* Ensure proper touch targets on mobile */
    button,
    input,
    select,
    textarea {
        min-height: 44px;
        /* iOS recommended minimum */
    }

    /* Improve text rendering on mobile */
    * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
}

@layer components {
    .btn-primary {
        @apply bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl;
    }

    .input-field {
        @apply w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-purple-300 focus:border-purple-400 bg-white/80 backdrop-blur-sm transition-all duration-300 text-gray-800 placeholder-gray-500 dark:bg-gray-900/60 dark:text-gray-100 dark:placeholder-gray-400 dark:border-gray-700 dark:focus:ring-purple-700 dark:focus:border-purple-700;
    }

    .card {
        @apply bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-purple-100 dark:bg-gray-900/80 dark:border-gray-700;
    }

    .icon-container {
        @apply flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-400 to-purple-600 text-white shadow-lg;
    }

    /* Mobile-first responsive utilities */
    .mobile-container {
        @apply px-3 sm:px-4 md:px-6;
    }

    .mobile-text {
        @apply text-sm sm:text-base md:text-lg;
    }

    .mobile-heading {
        @apply text-lg sm:text-xl md:text-2xl;
    }

    .mobile-padding {
        @apply p-3 sm:p-4 md:p-6;
    }

    .mobile-margin {
        @apply m-2 sm:m-3 md:m-4;
    }

    /* Enhanced animations */
    .animate-bounce-slow {
        animation: bounce 3s infinite;
    }

    .animate-pulse-slow {
        animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    /* Custom gradient text */
    .gradient-text {
        @apply bg-gradient-to-r from-purple-600 to-purple-800 bg-clip-text text-transparent;
    }

    /* Enhanced glow effects */
    .glow-purple {
        box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
    }

    .glow-purple:hover {
        box-shadow: 0 0 30px rgba(168, 85, 247, 0.5);
    }

    /* Mobile drag and drop optimizations */
    .drag-handle {
        touch-action: none;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
    }

    .drag-active {
        touch-action: none !important;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    /* Prevent text selection during drag */
    .dragging {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    /* Enhanced text selection prevention */
    .select-none {
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        touch-action: manipulation;
    }

    /* Smooth drag transitions */
    .drag-transition {
        transition: transform 0.2s ease-out, opacity 0.2s ease-out;
    }

    /* Mobile touch feedback */
    .touch-feedback {
        -webkit-tap-highlight-color: transparent;
        touch-action: manipulation;
    }

    /* Floating animation variations */
    .float-delay-1 {
        animation-delay: 1s;
    }

    .float-delay-2 {
        animation-delay: 2s;
    }

    .float-delay-3 {
        animation-delay: 3s;
    }

    .float-delay-4 {
        animation-delay: 4s;
    }

    .float-delay-5 {
        animation-delay: 5s;
    }

    .float-delay-6 {
        animation-delay: 6s;
    }

    /* Enhanced card hover effects */
    .card-hover {
        @apply transition-all duration-500 hover:scale-105 hover:shadow-2xl;
    }

    /* Floating animation */
    @keyframes float {

        0%,
        100% {
            transform: translateY(0px);
        }

        50% {
            transform: translateY(-20px);
        }
    }

    .animate-float {
        animation: float 6s ease-in-out infinite;
    }

    /* Slide in animations */
    @keyframes slide-in-from-bottom-4 {
        from {
            opacity: 0;
            transform: translateY(1rem);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slide-in-from-top-2 {
        from {
            opacity: 0;
            transform: translateY(-0.5rem);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-in {
        animation-fill-mode: both;
    }

    .slide-in-from-bottom-4 {
        animation: slide-in-from-bottom-4 0.3s ease-out;
    }

    .slide-in-from-top-2 {
        animation: slide-in-from-top-2 0.2s ease-out;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
    }

    ::-webkit-scrollbar-track {
        background: #f3e8ff;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: #c084fc;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #a855f7;
    }

    /* Mobile-specific improvements */
    @media (max-width: 640px) {
        .mobile-touch-target {
            min-height: 44px;
            min-width: 44px;
        }

        .mobile-text-small {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .mobile-hidden {
            display: none;
        }
    }

    /* Ensure modals are properly positioned on mobile */
    .modal-mobile {
        @apply fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4;
    }

    .modal-content-mobile {
        @apply bg-white rounded-2xl p-4 sm:p-6 w-full max-w-sm sm:max-w-md mx-4 shadow-2xl max-h-[90vh] overflow-y-auto dark:bg-gray-900 dark:text-gray-100;
    }

    /* Prevent scaling of circular buttons and icons */
    .icon-button {
        @apply flex-shrink-0 transform-none;
    }

    .icon-button svg {
        @apply flex-shrink-0;
    }

    /* Ensure consistent circular button sizes */
    .circular-button {
        @apply flex-shrink-0 transform-none;
        transform: none !important;
    }

    .circular-button:hover {
        transform: none !important;
    }

    /* Prevent any scaling on circular elements */
    .no-scale {
        transform: none !important;
        transform-origin: center !important;
    }

    .no-scale:hover {
        transform: none !important;
    }

    /* Ensure perfect circles - prevent ovals */
    .perfect-circle {
        aspect-ratio: 1 / 1 !important;
        width: var(--circle-size, 32px) !important;
        height: var(--circle-size, 32px) !important;
        min-width: var(--circle-size, 32px) !important;
        min-height: var(--circle-size, 32px) !important;
        max-width: var(--circle-size, 32px) !important;
        max-height: var(--circle-size, 32px) !important;
        border-radius: 50% !important;
        flex-shrink: 0 !important;
        flex-grow: 0 !important;
    }

    /* Circle size variants */
    .circle-sm {
        --circle-size: 24px;
    }

    .circle-md {
        --circle-size: 32px;
    }

    .circle-lg {
        --circle-size: 40px;
    }

    .circle-xl {
        --circle-size: 48px;
    }

    /* Force circular buttons to maintain shape */
    button[class*="rounded-full"] {
        aspect-ratio: 1 / 1 !important;
        flex-shrink: 0 !important;
        flex-grow: 0 !important;
    }

    /* Ensure icons inside circles are centered and don't stretch */
    .perfect-circle svg,
    button[class*="rounded-full"] svg {
        width: 60% !important;
        height: 60% !important;
        max-width: 60% !important;
        max-height: 60% !important;
        flex-shrink: 0 !important;
    }

    /* Icon size variants for different circle sizes */
    .circle-sm svg {
        width: 50% !important;
        height: 50% !important;
        max-width: 50% !important;
        max-height: 50% !important;
    }

    .circle-md svg {
        width: 60% !important;
        height: 60% !important;
        max-width: 60% !important;
        max-height: 60% !important;
    }

    .circle-lg svg {
        width: 65% !important;
        height: 65% !important;
        max-width: 65% !important;
        max-height: 65% !important;
    }

    .circle-xl svg {
        width: 70% !important;
        height: 70% !important;
        max-width: 70% !important;
        max-height: 70% !important;
    }

    /* Custom scrollbar styles */
    .scrollbar-thin {
        scrollbar-width: thin;
        scrollbar-color: rgb(196 181 253) rgb(243 232 255);
    }

    .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
    }

    .scrollbar-thin::-webkit-scrollbar-track {
        background: rgb(243 232 255);
        border-radius: 3px;
    }

    .scrollbar-thin::-webkit-scrollbar-thumb {
        background: rgb(196 181 253);
        border-radius: 3px;
        transition: background 0.2s ease;
    }

    .scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background: rgb(167 139 250);
    }

    /* Enhanced scrollbar for preset dropdown */
    .preset-scrollbar {
        scrollbar-width: thin;
        scrollbar-color: rgb(147 51 234) rgb(243 232 255);
    }

    .preset-scrollbar::-webkit-scrollbar {
        width: 8px;
    }

    .preset-scrollbar::-webkit-scrollbar-track {
        background: rgb(243 232 255);
        border-radius: 4px;
        margin: 4px;
    }

    .preset-scrollbar::-webkit-scrollbar-thumb {
        background: rgb(147 51 234);
        border-radius: 4px;
        transition: background 0.2s ease;
    }

    .preset-scrollbar::-webkit-scrollbar-thumb:hover {
        background: rgb(126 34 206);
    }

    /* Prevent scroll chaining for dropdown */
    .dropdown-scroll-container {
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
    }

    /* Ensure dropdown doesn't interfere with page scroll */
    .dropdown-container {
        isolation: isolate;
        contain: layout style paint;
    }

    /* Neon helpers for dark mode */
    .neon-surface {
        transition: box-shadow 0.25s ease, border-color 0.25s ease, background-color 0.25s ease, transform 0.25s ease;
        will-change: box-shadow, transform;
    }

    .dark .neon-surface {
        box-shadow: 0 0 24px rgba(168, 85, 247, 0.25);
        border-color: rgba(168, 85, 247, 0.35) !important;
    }

    .dark .neon-surface:hover {
        box-shadow: 0 0 36px rgba(168, 85, 247, 0.45);
        transform: translateY(-1px) scale(1.01);
        animation: neon-pulse 2.4s ease-in-out infinite;
    }

    .neon-text {
        transition: text-shadow 0.2s ease;
    }

    .dark .neon-text {
        text-shadow: 0 0 8px rgba(168, 85, 247, 0.6);
    }

    .dark .card {
        box-shadow: 0 0 24px rgba(168, 85, 247, 0.25);
    }

    /* Light mode elevation helpers */
    .light-surface {
        transition: box-shadow 0.25s ease, border-color 0.25s ease, background-color 0.25s ease, transform 0.25s ease;
        will-change: box-shadow, transform;
    }

    :root .light-surface {
        box-shadow: 0 8px 24px rgba(17, 24, 39, 0.06), 0 2px 8px rgba(17, 24, 39, 0.04);
        border-color: rgba(168, 85, 247, 0.20) !important;
    }

    :root .light-surface:hover {
        box-shadow: 0 12px 28px rgba(17, 24, 39, 0.08), 0 4px 12px rgba(17, 24, 39, 0.06);
        transform: translateY(-1px) scale(1.005);
    }

    @keyframes neon-pulse {

        0%,
        100% {
            box-shadow: 0 0 24px rgba(168, 85, 247, 0.25);
        }

        50% {
            box-shadow: 0 0 36px rgba(168, 85, 247, 0.45);
        }
    }

    @media (prefers-reduced-motion: reduce) {

        .neon-surface,
        .light-surface,
        body::before {
            animation: none !important;
            transition: none !important;
        }
    }
}

@layer utilities {

    /* Remove spinner arrows for number inputs */
    .no-spinner::-webkit-outer-spin-button,
    .no-spinner::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    .no-spinner {
        -moz-appearance: textfield;
        appearance: textfield;
    }

    /* Compact input height override */
    .input-compact {
        min-height: 0 !important;
        height: 20px !important;
        line-height: 1 !important;
        padding-top: 0 !important;
        padding-bottom: 0 !important;
    }
}